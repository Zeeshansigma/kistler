window.REBASE=window.REBASE||{},REBASE.theme=REBASE.theme||{},function(t){window.addEventListener("load",function(){REBASE.theme.bindProductControls()},!1),t(function(){function e(){window.innerWidth<960?t(".product-detail__tabs li, .product-detail__tab").removeClass("selected"):(t(".product-detail__tabs li").first().addClass("selected"),t(".product-detail__tab").first().addClass("selected"))}t(".product-detail__tabs li, .mobile-tab-heading").on("click",function(){var e=window.innerWidth<960&&t(this).hasClass("selected");t(".product-detail__tabs li, .product-detail__tab, .mobile-tab-heading").removeClass("selected"),e||(t(this).addClass("selected"),t('.product-detail__tab[data-handle="'+t(this).data("handle")+'"]').addClass("selected"))}),e()}),REBASE.theme.appendToFilename=function(t,e){var a=t.lastIndexOf(".");return-1===a?t+e:t.substring(0,a)+e+t.substring(a)},REBASE.theme.unbindProductControls=function(){t(".add-item-section__toggle--add-on, #product-qty-input, #product-rating, #product-content-sections").off(".rbProduct")},REBASE.theme.bindProductControls=function(){document.dispatchEvent(new Event("REBASE:bindProductControls")),t(document).on("click.rbProduct",".product-header__reviews",function(e){t('.product-detail__tabs li[data-handle="reviews"]').trigger("click"),t("html, body").animate({scrollTop:t("#product-reviews").offset().top-104},500)}),t(".product__part--gallery").length&&(REBASE.theme.product_photo_gallery=new Swiper(".gallery",{effect:"fade",fadeEffect:{crossFade:!0},loop:!1,speed:500,pagination:{el:".swiper-pagination",type:"bullets"},navigation:{nextEl:".swiper-button-next",prevEl:".swiper-button-prev"}})),product=new REBASE.theme.Product({$container:t("#minicart-add-to-cart-form")})},REBASE.theme.Product=function(){function e(e){var a,i,n;this.variants=null,this.$container=e.$container,this.data=JSON.parse(document.getElementById("product__json").innerHTML),this.variant_inventory=JSON.parse(document.getElementById("variant__inventory").innerHTML),this.settings={single_variant_selector:".single-variant-select",single_option_selector:".single-option-select",original_select_id:"select#product-select"},this.data?(this._initVariants(),n=t(this.settings.single_variant_selector,this.$container),a=n.length?n:t(this.settings.single_option_selector,this.$container),i=a.first().attr("type"),"radio"===i||"checkbox"===i?a.filter(":checked:first").trigger("change"):a.first().trigger("change")):console&&console.log("Missing product json data!")}return e.prototype=t.extend({},e.prototype,{_initVariants:function(){var t={$container:this.$container,enable_history_state:!0,single_variant_selector:this.settings.single_variant_selector,single_option_selector:this.settings.single_option_selector,original_select_id:this.settings.original_select_id,product:this.data};this.variants=new REBASE.theme.Variants(t),this.$container.on("variantChange",this._updateAddToCart.bind(this)),this.$container.on("variantSpecsChange",this._updateSpecsData.bind(this)),this.$container.on("variantImageChange",this._updateImages.bind(this)),this.$container.on("variantPriceChange",this._updatePrice.bind(this)),this.$container.on("variantSKUChange",this._updateSKU.bind(this))},_updateAddToCart:function(e){var a=e.variant,i=e.all_variants_match_option1,n=t(e.target),r=n.attr("type"),s=t("#add-to-cart"),o=t("#add-to-cart-text"),d=o.data("sold-out-text"),c=o.data("not-available-text"),l=o.data("add-to-cart-text"),p=o.data("backorder-text"),h=t(".product-backorder"),_=a&&this.variant_inventory.filter(function(t){return t.id===a.id})[0].quantity;if(a?(a.available?(s.removeClass("disabled").removeAttr("disabled"),o.text(_<=0?p:l),t("#preorder_property").remove()):(s.addClass("disabled").attr("disabled","disabled"),o.text(d),t("#preorder_property").remove()),_<=0&&a.available?h.toggle(!0).append('<input id="preorder_property" type="hidden" name="properties[_backorder]" value="true" />'):(h.toggle(!1),t("#preorder_property").remove()),t(".mobile-variant-summary").html(a.options.join(" / "))):(s.addClass("disabled").attr("disabled","disabled"),o.text(c),t(".product-header__price").html("<span>"+c+"</span>").removeClass("on-sale"),t(".product-header__price--old").empty(),h.hide(),t("#preorder_property").remove(),t(".mobile-variant-summary").empty()),"radio"===r||"checkbox"===r)if(n.is(this.settings.single_variant_selector))n.parent(".variant-element").addClass("selected-variant").siblings().removeClass("selected-variant");else{n.parent(".swatch-element").addClass("selected-swatch").siblings().removeClass("selected-swatch");var u=t('input[data-index="option2"]'),v=u.map(function(){return t(this).val()}).get(),g=t.map(v,function(e){var a=!1;return t.each(i,function(t,i){i.option2===e&&i.available&&(a=!0)}),a?void 0:e});u.parent(".swatch-element").removeClass("swatch-unavailable"),t.each(g,function(e,a){u.each(function(){var e=t(this);e.val()===a&&e.parent(".swatch-element").addClass("swatch-unavailable")})})}},_updateSpecsData:function(e){var a,i,n;if(t(".product-option-spec, .product-variant-spec").remove(),!e.variant)return!1;a=this.data.options.slice().reverse(),i=e.variant.options.slice().reverse(),i.forEach(function(e,i){t('.product-detail__tab[data-handle="specs"] table, .product-detail__tabs li[data-handle="specs"] .mobile-tab-content table').prepend('<tr class="product-option-spec"><td>'+a[i]+"</td><td>"+e+"</td></tr>")}),n=e.variant.specs,""!==n&&n.split("|").forEach(function(e){var a=e.split(":")[0],i=e.split(":")[1];t('.product-detail__tab[data-handle="specs"] table, .product-detail__tabs li[data-handle="specs"] .mobile-tab-content table').append('<tr class="product-variant-spec"><td>'+a+"</td><td>"+i+"</td></tr>")})},_updateImages:function(e){var a=e.variant,i=t(".product__part--gallery figure");i.each(function(e,i){var n=t(i);a.featured_image&&a.featured_image.id===parseInt(n.data("image-id"))&&REBASE.theme.product_photo_gallery.slideTo(parseInt(n.data("swiper-slide-index")))})},_updatePrice:function(e){var a=e.variant,i=t(".product-header__price:not(.product-header__price--old)"),n=t(".product-header__price--old"),r=a.compare_at_price;i.html(Shopify.formatMoney(a.price,Shopify.money_format)),r&&r>a.price?(n.html(Shopify.formatMoney(r,Shopify.money_format)),i.addClass("on-sale")):(n.empty(),i.removeClass("on-sale"))},_updateSKU:function(e){t("#product-sku .product-meta-item-content").text(e.variant.sku)}}),e}(),REBASE.theme.Variants=function(){function e(e){this.$container=e.$container,this.product=e.product,this.single_variant_selector=e.single_variant_selector,this.single_option_selector=e.single_option_selector,this.original_select_id=e.original_select_id,this.enable_history_state=e.enable_history_state,this.current_variant={},this.specs=JSON.parse(document.getElementById("variant__specs").innerHTML),t(this.single_variant_selector,this.$container).on("change",this._onSingleVariantChange.bind(this)),t(this.single_option_selector,this.$container).on("change",this._onSelectChange.bind(this))}return e.prototype=t.extend({},e.prototype,{_getCurrentOptions:function(){var e=!1,a=t.map(t(this.single_option_selector,this.$container),function(a){var i=t(a),n=i.attr("type"),r={};return"radio"===n||"checkbox"===n?(e=!0,!!i[0].checked&&(r.value=i.val(),r.index=i.data("index"),r)):(r.value=i.val(),r.index=i.data("index"),r)});return e&&(a=a.filter(Boolean)),a},_getVariantFromOptions:function(){var e,a,i=this._getCurrentOptions(),n=this.product.variants;return a=t.grep(n,function(t){return i.every(function(e){return t[e.index]===e.value})}),e=t.grep(n,function(t){return t[i[0].index]===i[0].value}),a=a.length?a[0]:void 0,{variant_match:a,all_variants_match_option1:e}},_onSingleVariantChange:function(e){var a,i=parseInt(t(e.target).val());a=this.product.variants.find(function(t){return t.id===i}),this.$container.trigger({type:"variantChange",variant:a,all_variants_match_option1:null,target:e.target}),a?(this._updateMasterSelect(a),this._updateImages(a),this._updateSpecs(a),this._updatePrice(a),this._updateSKU(a),this.current_variant=a,this.enable_history_state&&this._updateHistoryState(a)):this.current_variant={}},_onSelectChange:function(t){var e,a=this._getVariantFromOptions();e=a.variant_match,this.$container.trigger({type:"variantChange",variant:e,all_variants_match_option1:a.all_variants_match_option1,target:t.target}),e?(this._updateMasterSelect(e),this._updateImages(e),this._updateSpecs(e),this._updatePrice(e),this._updateSKU(e),this.current_variant=e,this.enable_history_state&&this._updateHistoryState(e)):this.current_variant={}},_updateImages:function(t){var e=t.featured_image||{},a=this.current_variant.featured_image||{};t.featured_image&&e.src!==a.src&&this.$container.trigger({type:"variantImageChange",variant:t})},_updateSpecs:function(t){var e=this.specs.filter(function(e){return t.id===e.id});e&&e[0]&&(t.specs=e[0].specs),this.$container.trigger({type:"variantSpecsChange",variant:t})},_updatePrice:function(t){t.price===this.current_variant.price&&t.compare_at_price===this.current_variant.compare_at_price||this.$container.trigger({type:"variantPriceChange",variant:t})},_updateSKU:function(t){t.sku!==this.current_variant.sku&&this.$container.trigger({type:"variantSKUChange",variant:t})},_updateHistoryState:function(t){if(history.replaceState&&t){var e=window.location.protocol+"//"+window.location.host+window.location.pathname+"?variant="+t.id;window.history.replaceState({path:e},"",e)}},_updateMasterSelect:function(e){t(this.original_select_id,this.$container).val(e.id),t("#product-supplier-style").text(t("option:selected",this.original_select_id,this.$container).data("variant-ss"))}}),e}()}(jQuery);