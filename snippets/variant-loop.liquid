{% comment %}
{% assign kistler_metafield = prod_variant.metafields.kistler %}
{% for filter in collection.filters %}
      {% assign downcaseFilter = filter.label | downcase %}
  {% for active_filter in filter.active_values %}
    {{ active_filter.label }}
{% if kistler_metafield[downcaseFilter] contains active_filter.label%} 
show
{% else %}
hide
{% endif %}
    {% endfor %}
  {% endfor %}
  {% endcomment %}
 <article  
 itemtype="http://schema.org/Product"
  itemscope="itemscope" 
  class="{% if prod_variant.available == false%}product--unavailable {% endif %}column {% if classes %}{{ classes }}{% else %}column--xs-12 column--sm-6 column--sm-stretch column--md-4 column--md-stretch column--lg-3 column--lg-stretch{% endif %} product product--{{ prod.id }} product--{{ forloop.index }}{% if prod_variant.compare_at_price > prod_variant.price %} product--on-sale{% endif %}
{% assign kistler_metafield = prod_variant.metafields.kistler %}
{% assign show = false %}
{% assign matched_filters = 0 %}
{% assign active_filters_size = 0 %}
{% for filter in collection.filters %}
  {% assign downcaseFilter = filter.label | downcase | replace: " ", "_" %}

   {% if filter.active_values.size > 0 %}
    {% assign active_filters_size = active_filters_size | plus: 1 %}
   {% endif %}

  {% assign filter_matched = false %}
  
  {% for active_filter in filter.active_values %}
    kistler_metafield_downcaseFilter-{{ kistler_metafield[downcaseFilter] }}
    active_filter-{{ active_filter | json }}
    filter_matched-{{ filter.active_values | json }}
    {% if kistler_metafield[downcaseFilter] contains active_filter and filter_matched == false %}
      {% assign matched_filters = matched_filters | plus: 1 %}
      {% assign filter_matched = true %}
    {% endif %}
  {% endfor %}
  
{% endfor %}
matched_filters={{ matched_filters }}
active_filters_size={{ active_filters_size }}
{{ class }}
"
  data-bait="{{ prod_variant.metafields.kistler.baits | escape }}"
  data-structure="{{ prod_variant.metafields.kistler.cover | escape }}"
  data-lure-line-wt="{{ prod_variant.metafields.kistler.lure_weight_line_weight | escape }}"
  {% for option in prod.options_with_values %}
    {% assign value = prod_variant.options[forloop.index0] | replace: ' ', '' | replace: '"', '' | escape %}
    data-{{ option.name | handleize }}="{{ value  }}"
  {% endfor %}

  
  data-price="{{ prod_variant.price }}"
  data-series="{% for tag in prod.tags %}{% if tag contains 'Series:' %}{{ tag | split: ':' | last }}{% endif %}{% endfor %}"
>


{% comment %}
   {% assign kistler_metafield = prod_variant.metafields.kistler %}
{% assign active_filter_values = "" %}

{% for filter in collection.filters %}
  {% assign downcaseFilter = filter.label | downcase %}
  {% for active_filter in filter.active_values %}
    Active filters: {{ active_filter.label }}<br>
        {% assign my_array = active_filter.label | split: "," %}
    {% assign active_filter_values = active_filter_values | append: my_array | join: "," | remove: "\" %}
   
    {{ active_filter_values }} = filter-label - {{ downcaseFilter }} - {{ kistler_metafield | json }} <br>

   
    {% if active_filter_values contains kistler_metafield[downcaseFilter] %}
      {%- assign class = 'show' -%}
    {% else %}
      {%- assign class = 'hide' -%}
    {% endif %}{{ class }}<br>



  {% endfor %}
{% endfor %}

Active Filter Values Array: {{ active_filter_values }}





  {% assign kistler_metafield = prod_variant.metafields.kistler %}

  
  {% for metafield in kistler_metafield %}
      {% assign metaValues = metafield | slice: 1, metafield.size | join: ', ' %}
    {{ metafield[0] | handleize }}={{ metaValues }}<br><br>
    {% assign collectionFilters = collection.filters %}
    {% assign filter_active_values = filter.active_values %}

      
   {% for filter in collectionFilters %}
  {% for active_value in filter_active_values %}
   {% assign filterLabels = filter.label | handleize | downcase %}
   {% assign activeFilters = active_value.label %}
    {{ filterLabels }} = {{ activeFilters }}
 
     {% endfor %}
{% endfor %}
  {% endfor %} 
{% endcomment %}



 

  


  <div class="product__content">
    <div class="product__badges">
      {% if prod_variant.compare_at_price > prod_variant.price %}
         {% assign difference = prod_variant.compare_at_price | minus: prod_variant.price %}
        <div class="product__badge product__badge--sale">Save {{ difference | money_without_trailing_zeros }}</div>
      {% endif %}
    </div>
    <a itemprop="url" class="product__image-wrapper" href="{{ prod_variant.url | within: collection }}" title="{{ prod.title | strip_html | escape }}">
      <noscript>
        <img itemprop="image" class="product__image product__image--{{ prod_variant.id }}" srcset="{{ prod_variant.image | img_url: '800x' }} 2x, {{ prod_variant.image | img_url: '400x' }} 1x" src="{{ prod_variant.image | img_url: '400x' }}" data-default-image="{{ prod_variant.image | img_url: '800x' }}" alt="{% if prod_variant.image.alt != blank %}{{ prod_variant.image.alt | escape }}{% else %}{{ prod.title | escape}}{% endif %}">
      </noscript>
        <img itemprop="image" class="product__image product__image--{{ prod_variant.id }}" srcset="{{ prod_variant.image | img_url: '800x' }} 2x, {{ prod_variant.image | img_url: '400x' }} 1x" src="{{ prod_variant.image | img_url: '400x' }}" data-default-image="{{ prod_variant.image | img_url: '800x' }}" alt="{% if prod_variant.image.alt != blank %}{{ prod_variant.image.alt | escape }}{% else %}{{ prod.title | escape}}{% endif %}">
      <!-- <img itemprop="image" class="product__image product__image--{{ prod_variant.id }} lazy" data-srcset="{{ prod_variant.image | img_url: '800x' }} 2x, {{ prod_variant.image | img_url: '400x' }} 1x" data-src="{{ prod_variant.image | img_url: '400x' }}" data-default-image="{{ prod_variant.image | img_url: '800x' }}" alt="{% if prod_variant.image.alt != blank %}{{ prod_variant.image.alt | escape }}{% else %}{{ prod.title | escape}}{% endif %}"> -->
    </a>
    <header class="product__header">
      <h2 class="product__title">
        <a href="{{ prod_variant.url | within: collection }}" title="{{ prod.title | strip_html | escape }}" itemprop="name">{{ prod.title }}</a>
      </h2>
      <span class="product__meta product__meta--options">{{ prod_variant.title }}</span>
      <span class="product__meta product__meta--pricing" itemprop="offers" itemtype="http://schema.org/Offer" itemscope="itemscope">
        {% if prod_variant.available %}
          <meta itemprop="priceCurrency" content="{{ shop.currency }}">
          {% if prod_variant.compare_at_price > prod_variant.price %}
            <span class="product__old-price">
              {% if prod_variant.compare_at_price > 0 %}
                 {{ prod_variant.compare_at_price | money }}
              {% endif %}
            </span>
          {% endif %}
          <span class="product__price" itemprop="price">{{ prod_variant.price | money }}</span>
        {% else %}
          <span class="product__price">SOLD OUT</span>
        {% endif %}
      </span>
    </header>
  </div>
</article>
<style>

  article.hide{
       display: none;
  }
      article.show {
    display: block;
}

</style>

