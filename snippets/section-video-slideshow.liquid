<section class="section section--video-slideshow section--video-slideshow--{{ block.id }}
  {% if block.settings.full_width %}section--video-slideshow--full-width{% endif %}
  {% unless block.settings.top_padding %}section--video-slideshow--no-top-padding{% endunless %}
  {% unless block.settings.bottom_padding %}section--video-slideshow--no-bottom-padding{% endunless %}" {{ block.shopify_attributes }}>
   
  <style>
    {%- if block.settings.video_overlay_color != blank -%}
      .section--video-slideshow--{{ block.id }} .video__image:after {
        background-color: {{ block.settings.video_overlay_color | color_modify: 'alpha', 0.75 }};
      }
    {%- endif -%}

    {%- if block.settings.bkgd_color -%}
      .section--video-slideshow--{{ block.id }} { 
        background-color: {{ block.settings.bkgd_color }}; 
      }
    {%- endif -%}

    {%- if block.settings.text_color -%}
      .section--video-slideshow--{{ block.id }},
      .section--video-slideshow--{{ block.id }} .video-slideshow__heading { 
        color: {{ block.settings.text_color }}; 
      }
    {%- endif -%}
  </style>
    
  <div class="container">
    {%- if block.settings.title != blank -%}
      <h2 class="video-slideshow__heading">{{ block.settings.title }}</h2>
    {%- endif -%}
    {%- if block.settings.description != blank -%}
      <div class="video-slideshow__description">{{ block.settings.description }}</div>
    {%- endif -%}
  
    <div class="swiper-wrap">
      <div id="video-swiper--{{ block.id }}" class="swiper-container video-swiper">
        <div class="swiper-wrapper">
          {%- if block.settings.show_video_1 -%}
            <div class="swiper-slide">
              <div class="video-container">
                <div class="yt-player" data-id="{{ block.settings.video_url_1.id }}"></div>
              </div>
            </div>
          {%- endif -%}
          {%- if block.settings.show_video_2 -%}
            <div class="swiper-slide">
              <div class="video-container">
                <div class="yt-player" data-id="{{ block.settings.video_url_2.id }}"></div>
              </div>
            </div>
          {%- endif -%}
          {%- if block.settings.show_video_3 -%}
            <div class="swiper-slide">
              <div class="video-container">
                <div class="yt-player" data-id="{{ block.settings.video_url_3.id }}"></div>
              </div>
            </div>
          {%- endif -%}
          {%- if block.settings.show_video_4 -%}
            <div class="swiper-slide">
              <div class="video-container">
                <div class="yt-player" data-id="{{ block.settings.video_url_4.id }}"></div>
              </div>
            </div>
          {%- endif -%}
          {%- if block.settings.show_video_5 -%}
            <div class="swiper-slide">
              <div class="video-container">
                <div class="yt-player" data-id="{{ block.settings.video_url_5.id }}"></div>
              </div>
            </div>
          {%- endif -%}
          {%- if block.settings.show_video_6 -%}
            <div class="swiper-slide">
              <div class="video-container">
                <div class="yt-player" data-id="{{ block.settings.video_url_6.id }}"></div>
              </div>
            </div>
          {%- endif -%}
          {%- if block.settings.show_video_7 -%}
            <div class="swiper-slide">
              <div class="video-container">
                <div class="yt-player" data-id="{{ block.settings.video_url_7.id }}"></div>
              </div>
            </div>
          {%- endif -%}
          {%- if block.settings.show_video_8 -%}
            <div class="swiper-slide">
              <div class="video-container">
                <div class="yt-player" data-id="{{ block.settings.video_url_8.id }}"></div>
              </div>
            </div>
          {%- endif -%}
          {%- if block.settings.show_video_9 -%}
            <div class="swiper-slide">
              <div class="video-container">
                <div class="yt-player" data-id="{{ block.settings.video_url_9.id }}"></div>
              </div>
            </div>
          {%- endif -%}
          {%- if block.settings.show_video_10 -%}
            <div class="swiper-slide">
              <div class="video-container">
                <div class="yt-player" data-id="{{ block.settings.video_url_10.id }}"></div>
              </div>
            </div>
          {%- endif -%}
        </div>
      </div>

      <div class="swiper-button-prev {% if block.settings.invert_arrows %}swiper-button-white{% else %}swiper-button-black{% endif %}"></div>
      <div class="swiper-button-next {% if block.settings.invert_arrows %}swiper-button-white{% else %}swiper-button-black{% endif %}"></div>
    </div>

    <div id="video-thumbs-swiper--{{ block.id }}" class="thumbs-swiper-container video-thumb-swiper {% if block.settings.invert_arrows %}invert-arrows{% endif %}">
      <div class="swiper-wrapper">
        {%- if block.settings.show_video_1 -%}
          <div class="swiper-slide">
            <figure class="lazy video__image" data-src="{{ block.settings.image_1 | img_url: '400x' }}">
              <figcaption class="video__content">
                <div class="video__play">{% include 'icon-play.svg' %}</div>
              </figcaption>
            </figure>
          </div>
        {%- endif -%}
        {%- if block.settings.show_video_2 -%}
          <div class="swiper-slide">
            <figure class="lazy video__image" data-src="{{ block.settings.image_2 | img_url: '400x' }}">
              <figcaption class="video__content">
                <div class="video__play">{% include 'icon-play.svg' %}</div>
              </figcaption>
            </figure>
          </div>
        {%- endif -%}
        {%- if block.settings.show_video_3 -%}
          <div class="swiper-slide">
            <figure class="lazy video__image" data-src="{{ block.settings.image_3 | img_url: '400x' }}">
              <figcaption class="video__content">
                <div class="video__play">{% include 'icon-play.svg' %}</div>
              </figcaption>
            </figure>
          </div>
        {%- endif -%}
        {%- if block.settings.show_video_4 -%}
          <div class="swiper-slide">
            <figure class="lazy video__image" data-src="{{ block.settings.image_4 | img_url: '400x' }}">
              <figcaption class="video__content">
                <div class="video__play">{% include 'icon-play.svg' %}</div>
              </figcaption>
            </figure>
          </div>
        {%- endif -%}
        {%- if block.settings.show_video_5 -%}
          <div class="swiper-slide">
            <figure class="lazy video__image" data-src="{{ block.settings.image_5 | img_url: '400x' }}">
              <figcaption class="video__content">
                <div class="video__play">{% include 'icon-play.svg' %}</div>
              </figcaption>
            </figure>
          </div>
        {%- endif -%}
        {%- if block.settings.show_video_6 -%}
          <div class="swiper-slide">
            <figure class="lazy video__image" data-src="{{ block.settings.image_6 | img_url: '400x' }}">
              <figcaption class="video__content">
                <div class="video__play">{% include 'icon-play.svg' %}</div>
              </figcaption>
            </figure>
          </div>
        {%- endif -%}
        {%- if block.settings.show_video_7 -%}
          <div class="swiper-slide">
            <figure class="lazy video__image" data-src="{{ block.settings.image_7 | img_url: '400x' }}">
              <figcaption class="video__content">
                <div class="video__play">{% include 'icon-play.svg' %}</div>
              </figcaption>
            </figure>
          </div>
        {%- endif -%}
        {%- if block.settings.show_video_8 -%}
          <div class="swiper-slide">
            <figure class="lazy video__image" data-src="{{ block.settings.image_8 | img_url: '400x' }}">
              <figcaption class="video__content">
                <div class="video__play">{% include 'icon-play.svg' %}</div>
              </figcaption>
            </figure>
          </div>
        {%- endif -%}
        {%- if block.settings.show_video_9 -%}
          <div class="swiper-slide">
            <figure class="lazy video__image" data-src="{{ block.settings.image_9 | img_url: '400x' }}">
              <figcaption class="video__content">
                <div class="video__play">{% include 'icon-play.svg' %}</div>
              </figcaption>
            </figure>
          </div>
        {%- endif -%}
        {%- if block.settings.show_video_10 -%}
          <div class="swiper-slide">
            <figure class="lazy video__image" data-src="{{ block.settings.image_10 | img_url: '400x' }}">
              <figcaption class="video__content">
                <div class="video__play">{% include 'icon-play.svg' %}</div>
              </figcaption>
            </figure>
          </div>
        {%- endif -%}
      </div>
    </div>
  </div>
  <script>
    document.addEventListener('DOMContentLoaded', function () {
      (function($) {
        $(function() {
          var players = [];

          // Include YT script if needed
          if (!$('#yt_iframe_api').length) {
            var tag = document.createElement('script');

            tag.id = 'yt_iframe_api';
            tag.src = 'https://www.youtube.com/iframe_api';

            var firstScriptTag = document.getElementsByTagName('script')[0];
            firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);
          }

          window.queueOnYoutubeIframeAPIReady(function () {
            var slides = $('#video-swiper--{{ block.id }} .swiper-slide');
            
            slides.each(function(indx, el) {
              var slide_yt_player = $(el).find('.yt-player');
              var player = new YT.Player(slide_yt_player.get(0), {
                height: '390',
                width: '640',
                videoId: slide_yt_player.data('id'),
                playerVars: {
                  autoplay: 0,
                  modestbranding: 1,
                  playsinline: 1,
                  rel: 0
                }
              });

              players.push(player);
            });
          });

          var thumbSwiper = new Swiper('.section--video-slideshow--{{ block.id }} .thumbs-swiper-container', {
            slidesPerView: 3.5,
            spaceBetween: 10,
            freeMode: {
              enabled: true,
              sticky: true
            },
            slideToClickedSlide: true,
            centerInsufficientSlides: true,
            watchSlidesProgress: true,
            breakpoints: {
              768: { // when window width is <= 768px
                slidesPerView: 2.5,
                spaceBetweenSlides: 20
              }
            }
          });

          var videoSlideshowSwiper = new Swiper('.section--video-slideshow--{{ block.id }} .swiper-container', {
            effect: 'slide',
            spaceBetween: 0,
            slidesPerView: 1,
            centeredSlides: true,
            navigation: {
              nextEl: '.section--video-slideshow--{{ block.id }} .swiper-button-next',
              prevEl: '.section--video-slideshow--{{ block.id }} .swiper-button-prev'
            },
            on: {
              slideChange: function() {        
                players[videoSlideshowSwiper.previousIndex].pauseVideo();

                // if (thumbSwiper.clickedIndex === videoSlideshowSwiper.activeIndex) {
                //     players[videoSlideshowSwiper.activeIndex].playVideo();
                // }
              }
            },
            thumbs: {
              swiper: thumbSwiper
            }
          });

                  

        });
      })(jQuery)
    });
  </script>
</section>